# -*- coding: utf-8 -*-
"""
Created on Tue Sep 30 11:31:20 2025

@author: stefa
"""

from rembg import remove, new_session
import cv2
import numpy as np
import os

# Pad naar je map
folder_path = 'C:\\Users\\stefa\\Documents\\beeldherkenning\\1.3'
files = [f for f in os.listdir(folder_path) if f.lower().endswith(('.jpg', '.png', '.jpeg'))]

# Eén keer model laden
session = new_session("u2net")

alle_kleuren = []

for file in files:
    input_path = os.path.join(folder_path, file)

    img = cv2.imread(input_path)
    img_rgb = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)

    # Achtergrond verwijderen met bestaande sessie
    output = remove(img_rgb, session=session)
    output = np.array(output)

    # Mask voor transparante pixels
    mask = output[:, :, 3] != 0
    dier_rgb = output[:, :, :3]

    # Gemiddelde kleur
    gemiddelde_kleur = dier_rgb[mask].mean(axis=0)
    alle_kleuren.append(gemiddelde_kleur)

    print(f"{file} → Gemiddelde kleur: {gemiddelde_kleur}")

# Gemiddelde over alle foto’s
alle_kleuren = np.array(alle_kleuren)
totaal_gemiddelde = alle_kleuren.mean(axis=0)
print("\nGemiddelde kleur van ALLE dieren:", totaal_gemiddelde)
